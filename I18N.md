# GO-Commerce Internationalization Guide

This document describes the internationalization (i18n) support in the GO-Commerce platform, including how to use and extend the translation capabilities.

## Overview

GO-Commerce provides robust internationalization support through standard Java resource bundles combined with a flexible locale resolution strategy. This enables the platform to serve content in multiple languages based on user preferences.

### Supported Languages

The platform currently supports the following languages:

- English (default)
- Brazilian Portuguese (`pt_BR`)
- Portuguese (`pt`)
- Spanish

## Key Components

### 1. LocaleResolver Interface

The `LocaleResolver` interface provides a strategy pattern for determining the current locale:

```java
public interface LocaleResolver {
    Locale getLocale();
    void setLocale(Locale locale);
    void setLocale(String languageTag);
}
```

### 2. RequestLocaleResolver Implementation

The default implementation, `RequestLocaleResolver`, determines the locale based on the following prioritized sources:

1. URL parameter: `?lang=en`
2. Cookie: `locale=en`
3. Accept-Language HTTP header
4. Default locale (configurable)

### 3. MessageService

The `MessageService` provides a centralized way to retrieve internationalized messages:

```java
// Get message in current locale
String message = messageService.getMessage("key");

// Get message with parameter substitution
String validationMsg = messageService.getMessage("validation.minLength", 8);

// Get message in specific locale
String spanishMsg = messageService.getMessage("product.name", Locale.forLanguageTag("es"));
```

### 4. REST API for Locale Management

The platform exposes REST endpoints for retrieving and changing the current locale:

- `GET /api/locale` - Returns current locale info and sample messages
- `POST /api/locale/{localeTag}` - Changes the current locale (e.g., `POST /api/locale/pt_BR`)

## Message Resource Bundles

Translations are stored in standard Java properties files:

- `messages.properties` - Default/English messages
- `messages_es.properties` - Spanish messages
- `messages_pt_BR.properties` - Brazilian Portuguese messages
- `messages_pt.properties` - Portuguese messages (generic)

Example format:
```
product.name=Product Name
customer.firstName=First Name
validation.minLength=Minimum length is {0} characters
```

## Adding New Languages

To add support for a new language:

1. Create a new resource bundle file with the appropriate suffix (e.g., `messages_fr.properties` for French)
2. Add translations for all message keys
3. Update the `supportedLocales` property in `application.properties` if using explicit locale validation

## Configuring Default Behavior

The following properties can be configured in `application.properties`:

```properties
# Default locale to use when no preference is detected
gocommerce.i18n.default-locale=en

# Optional comma-separated list of supported locales (for validation)
gocommerce.i18n.supported-locales=en,es,pt_BR,pt

# Cookie name used to store locale preference
gocommerce.i18n.locale-cookie-name=locale
```

## Best Practices

1. **Key Organization**: Group message keys by feature area (e.g., `product.`, `customer.`, etc.)
2. **Parameter Usage**: Use placeholders `{0}`, `{1}`, etc. for dynamic content
3. **Consistency**: Ensure all supported languages have the same set of message keys
4. **Completeness**: When adding new UI text, add entries to all message bundles
5. **Context**: Include context comments above complex messages for translators

## Testing Internationalization

Test the locale change with:

```
curl -X POST -H "Content-Type: application/json" http://localhost:8080/api/locale/es
curl -X POST -H "Content-Type: application/json" http://localhost:8080/api/locale/pt_BR
curl http://localhost:8080/api/locale
```

## Future Enhancements

- Resource bundle hot reloading
- Admin interface for managing translations
- Support for right-to-left languages
- Translation workflow integration
- Language selection UI components